services:
  - type: worker
    name: maps-scraper
    env: python
    runtime: python3.11
    buildCommand: |
      apt-get update
      apt-get install -y chromium-browser wget unzip
      CHROME_VERSION=$(chromium-browser --version | awk '{print $2}')
      MAJOR_VERSION=${CHROME_VERSION%%.*}
      wget https://chromedriver.storage.googleapis.com/LATEST_RELEASE_$MAJOR_VERSION -O LATEST
      DRIVER_VERSION=$(cat LATEST)
      wget https://chromedriver.storage.googleapis.com/$DRIVER_VERSION/chromedriver_linux64.zip
      unzip chromedriver_linux64.zip
      mv chromedriver /usr/local/bin/chromedriver
      chmod +x /usr/local/bin/chromedriver
      pip install -r requirements.txt
    startCommand: python maps_scraper.py
